# 写在前面的话
long long ago `未配置OS的系统`和`单道批处理系统`中，程序的执行方式是顺序执行，也就是内存中只装入一道用户程序，独占系统资源，只有在一个用户程序执行完毕后下一个程序才能被装入执行。这种方式浪费资源，系统运行效率低。

后来，多道程序系统中内存可以同时装入多个程序，他们共享系统资源、并发执行，可以克服上面的缺点。

> 程序的两种执行方式有着显著不同的特点，尤其考虑到程序的并发执行，于是OS中引入了`进程`的概念。

# 程序的执行
## 程序的顺序执行
### 程序顺序执行的特征
+ 1.顺序性：处理机严格按照程序规定的顺序执行，每一操作必须在下一操作开始之前结束；
+ 2.封闭性：程序在封闭的环境下运行，独占全机资源，除初始状态以外资源的状态只能由本程序才能改变，结果不受外界因素影响；
+ 3.可再现性：只要程序执行时的环境和初始条件相同，都能获得相同的结果。

## 程序的并发执行
程序顺序执行可以给程序员带来便利，然是系统资源利用率很低，于是在`OS`中引入了多道程序技术，能够令程序间`并发执行`。但是并非所有的程序都能够并发执行，只有在`不存在前驱关系`的程序之间才有可能并发执行。

### 程序的并发执行的特征
引入程序间的并发执行后，提高了系统的吞吐量和资源利用率，但是由于他们共享系统资源，为完成同一任务相互合作，导致并发执行的程序之间形成相互制约的关系，带来新的特征：
1. 间断性：程序在并发执行时，只有当其前驱程序完成执行后才能执行，所以并发程序具有“执行——暂停——执行”这种间断性规律；
2. 失去封闭性：系统中的资源被共性，而这些资源的状态也由这些程序来改变，所以改变资源的就不仅仅是本程序了，也就失去了封闭性。
3. 不可再现性：程序失去封闭性，必然导致失去可再现性。

# 进程的描述

## 进程的定义和特征
为了能是程序并发执行，而且可以对并发执行的程序加以描述和控制，人们引入了`进程`的概念。
### 进程的定义
为了使参加并发执行的程序都能够独立的运行，在OS中必须为之配置一个专门的数据结构————进程控制块(Process Control Block, PCB)。利用PCB来描述进程的基本情况和活动过程，进而控制和管理进程。

由`程序段、相关数据段和PCB`三部分构成了`进程实体`（又称为进程映像）。一般情况下，进程实体简称为进程。例如：创建进程实质上是创建进程实体中的PCB，撤销进程实质上是撤销进程实体的PCB。

**定义**：进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。

> 简单理解，进程就是执行的程序。

### 进程的特征
1. 动态性：进程的实质是进程实体的执行过程，所以程序是静态的，进程是动态的；
2. 并发性：多个进程实体同存于内存中，可以并发执行。程序是没有PCB的，所以不能参与并发执行。
3. 独立性：进程实体是能够独立运行、独立获得资源、独立接受调度的基本单位。未建立PCB的程序都不能座位一个独立的单位参与运行。
4. 异步性：即进程按照各自独立的、不可预知的速度向前推进。而传统意义上的程序如果参与并发执行，结果会不可再现。而进程虽然具有异步性，但是在配置相应的进程同步机制后，仍然能够保证并发执行的结果是可再现的。

# 进程的状态及转换
## 进程的三种基本状态
1. 就绪状态(Ready):进程依分配到除CPU以外的所有必要资源，只要再获得CPU便可立即执行。如果系统中有许多处于就绪状态的进程，通常将他们按照一定的策略排成一个队列，也就是`就绪队列`。
2. 执行状态(Running):进程已经获得CPU，其程序正在执行。在单处理机系统中只能有一个进程处于Running，对于多处理机系统而言可以有多个进程处于此状态。
3. 阻塞状态(Block):正在执行的进程由于发生某事件(比如I/O请求、申请缓冲区失败)无法继续执行。此时引起进程调度，OS讲处理机分配给另一个就绪进程，将受阻进程处于暂停状态，阻塞状态的进程也会被排成一个队列，成为`阻塞队列`。在较大的系统中，对于不同的阻塞原因，会设置多个不同的阻塞队列。此状态又称为`等待状态`或`封锁状态`。

## 三种基本状态的转换
![](https://user-gold-cdn.xitu.io/2018/11/17/1672099b4aaa8d9f?w=743&h=499&f=png&s=31857)


## 创建状态和终止状态
### 创建状态
创建一个进程是一个很复杂的过程，需要通过多个步骤才能完成：
1. 首先由进程申请一个空白PCB，并向PCB中填写用于控制和管理进程的信息；
2. 然后为该进程分配运行时所必须的资源；
3. 最后将该进程转入就绪状态并插入就绪队列之中。

但是如果进程所需的组员尚不能得到满足，比如系统没有足够的内存，此时创建工作尚未完成，进程不能被调度执行，将进程此时所处的状态称为`创建状态`。

### 终止状态
进程的终止也是需要一个过程的：
1. 等待OS进行善后处理
2. 将PCB清零，将PCB空间返还系统。

如果一个进程到达了自然结束点，或者出现了无法克服的错误，要么被OS终结，要么被其他有终止权的进程终结，它将进入`终止状态`。

> 终止状态的进程不能再执行，但是OS中依然保留一个记录，其中保存`状态码`和一些`计时统计数据`供其他进程手收集。一旦完成对其信息的提取，OS将删除该进程。即将PCB清零，将空白OCB返回系统。

![](https://user-gold-cdn.xitu.io/2018/11/17/16720b5da4168e25?w=814&h=498&f=png&s=38732)


## 挂起和进程状态的转换
在许多OS种除了就绪执行和阻塞三种最基本的状态以外呢，为了系统和用户观察和进程的需要，还引入了一个对进程的重要操作————挂起。

某个进程被挂起时，该进程处于静止状态，如果该进程正在执行，则暂停执行，若原本就处于就绪状态，则该进程暂不接受调度。与`挂起`对应的是`激活`。

### 挂起操作的引入
引入挂起的原因呢，如下所示：
1. 终端用户的需要：有的用户需要暂停自己的程序，以便研究其执行情况，对程序进行修改。
2. 父进程请求：有事父进程希望挂起某个子进程，以便查看和修改子进程或者协调子进程间的活动。
3. 负荷调节的需要：当时候是OS的工作负荷较重时，会把一些不重要的进程挂起。
4. OS的需要：OS有时需要挂起某些进程，以便检查运行中的资源使用情况或进行记账。

### 引入挂起操作后三个进程状态的转换
1. 活动就绪=>静止就绪
2. 活动阻塞=>静止阻塞
3. 静止就绪=>活动就绪
4. 静止阻塞=>活动阻塞



## 进程管理中的数据结构
