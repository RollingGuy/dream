# 浏览器运行原理

浏览器是一个多进程的应用，其中的主进程中又包含了 js 线程、UI 渲染线程、事件线程、定时器触发线程、HTTP 请求线程等等。

而 js 是可以操作 DOM 的，如果在 UI 渲染的过程中允许 js 操作 DOM，则会造成结果的不可预期，所以互斥了 js 于 UI 的执行。在 js 执行的过程中 UI 会被挂起，UI 的更新会被保存到队列中，当 js 执行完毕后再清空这个队列。

而对于事件线程，每当一个事件被触发，事件线程就会把相应的 callback push 到队末，等待 js 线程空闲后处理。

所以当 js 长时间执行时，UI、事件都得不到及时的执行，就会给用户造成页面卡顿，触发的事件也得不到响应。

sync 模式下的问题就是因为浏览器的运行原理造成的。当然，造成页面卡顿的原因也不仅仅就是 js 的执行，有时候长时间的 paint、layout 也会造成卡顿。但是 jser 可控的只有 js。

> 对于浏览器各个线程的具体作用以及具体细节会在之后的关于 browser 系列文章写，现在只需要关系大概的原理即可。

那既然长时间执行 js 会造成以上后果，这个执行时间是多少合适？现在大多数设备的刷新频率是 60FPS，所以每一次更新显示器之间的间隔时间就是 1 / 60s = 16.66mm。
