# 人眼的感知极限

85hz 是人类大脑处理视频的极限。画面帧率高于 10-12frame 的时候就会认为是连贯的，一般电影的拍摄以及播放的帧数是 24frame

# 目前显示性能优化的极限

60fps

# 高性能动画

页面的每一帧变化是由 GPU 或 CPU 绘制出来的（也就是系统），这和游戏的绘制不同，它的最高绘制频率是受限于显示器的刷新频率（而不是显卡），所以大多数情况下最高的绘制频率是 60fps。

也就是说留给我们绘制一帧的时间只有 16.6ms。所以不能使用 timer 来进行延时控制绘制。

首先因为 timer 的计算精度是依靠浏览器内置的时钟，时钟的精度有取决于时钟更新的频率，精度不够。IE8 及之前的 IE 版本对于时钟的刷新间隔是 15.6ms，这就意味着，你写下`setTimeout(() => do(), 16.6)`,第一次 check 在 15.6ms 之后，发现没有到期，再经过 15.6ms 之后才发现到期，然后执行。但是就比我们预期的要晚了`15.6 * 2 - 16.6 = 14.5ms`。

> 现在规范对于 timer 的延迟是最大不超过 4ms（但是如果在关闭电源的情况下，笔记本省电模式刷新频率会更低）

这个是无关乎 js 引擎层面的延迟，退一步即使精度能够达到要求，还有异步队列等等情况。

# 屏幕刷新频率和 GPU 渲染频率

屏幕的刷新频率单位是 hz。fps 是 GPU 渲染画面的频率。

我们谈到的掉帧指的都是 GPU 渲染的频率降低。而一旦 GPU 的频率比显示器刷新频率要搞，那会造成屏幕撕裂问题，也就是上半部分是前一张，下半部分是后一张。

PC 游戏解决这个问题是开启垂直同步 V-sync，也就是让 GPU 妥协，GPU 的刷新必须要在显示器两次刷新之间，而且必须要等待屏幕发出的垂直同步信号。代价就是降低了 GPU 的输出频率，也就降低了画面的帧数。以至于你在玩需要高帧数运行的游戏时 (比如竞速、第一人称射击) 感觉到“顿卡”，因为掉帧。
