# 基础篇
数据库是每个计算机专业的人所必回的一门课程，所以现在准备好好补一补，既是为了通过考试，也是为了之后找工作多一分竞争力。

MySQL系列打算跟着《数据库系统概论》这本书进行学习，所以将会有四篇。本文是这个系列的第一篇。

# 绪论
## 数据库系统概述
先来介绍一下数据库的4个基本概念：数据、数据库、数据库管理系统、数据库系统

### 1、数据(data)
定义：描述事物的符号记录称为`数据`。数据的含义成为数据的`语义`,数据与其语义是不可分的。
> `记录`是计算机中表示和存储数据的一种格式或方法。

### 2、数据库(DataBase, DB)
数据库，顾名思义就是存放数据的仓库。

严格地讲：数据库是长期存储在计算机内、有组织的、可共享的大量数据的集合。

数据库中的数据按照一定的数据模型组织、描述和存储，具有较小的冗余度、较高的数据独立性和易扩展性，并且可为各种用户共享。
> 概括地讲，数据库数据具有永久存储、有组织和可共享三个基本特点。

### 3、数据管理系统(DataBase Mangement System, DBMS)
首先明确一点，DBMS是一个系统软件。

它的主要功能包括：
1. 数据定义
2. 数据组织、存储和管理
3. 数据操纵功能
4. 数据库的事物管理和运行管理
5. 数据库的建立和维护功能
6. 其他功能

### 4、数据库系统(DataBase, DBS)
数据库系统是由数据库、数据库管理系统（以及其应用开发工具）、应用程序和数据库管理员组成的存储、管理、处理和维护数据的系统。

## 数据库系统的特点

### 1、数据结构化
这是数据的主要特征之一，也是数据库系统与文件系统的本质区别。
> 在文件系统中，文件中的记录内部具有结构，但是记录的结构和记录之间的联系被固化在程序中。而数据库中的数据不在仅仅针对某一个程序而是面向整个组织或企业。

### 2、数据共享性高、冗余度低且易扩充
因为数据库系统从整体角度来描述、看待数据，所以数据不再面向某个应用而是面向整个系统，可以被多个用户、程序去共享使用。这样一来也方便对原有数据的扩充。

数据共享可以大大减少数据的冗余，还能避免数据之间的不相容性与不一致性。

在使用这些数据的时候只需要选取数据库中的子集即可，当应用需求改变或者增加时，只需要重新选取不同的子集即可。

### 3、数据独立性高
数据独立性包括物理独立性和逻辑独立性。
+ 物理独立性：用户的应用程序与数据库中数据的物理存储是相互独立的。当数据库中数据的存储改变时，用户程序不需要做出任何改变。
+ 逻辑独立性：应用程序与数据库的逻辑是相互独立的。当数据库中数据的逻辑结构改变时，用户程序也可以不变。

### 4、数据由数据库管理系统统一管理和控制
数据库的共享会带来数据库的安全隐患，比如并发控制。为此DBMS还需要提供以下几方面的数据控制功能。
1. 数据的安全性保护：保护数据防止不合法使用造成数据泄密和破坏。每个用户只能按规定对某些数据以某些方式进行使用。
2. 数据的完整性检查：数据的完整性指数据的正确性、有效性和相容性。
3. 并发控制：多个用户同时对数据进行修改、存取时可能会发生相互干扰从而引发错误，或者令数据库的完整性遭到破坏，因此必须对多用户的并发操作加以控制和协调。
4. 数据库恢复：某些操作使得数据库部分数据或者全部数据丢失时，DBMS必须具有将数据库从错误状态恢复到某个正确状态的状态的功能。

## 数据模型
数据模型：是对现实世界数据特征的抽象。一般的讲，数据模型是严格定义的一组概念的集合。

数据模型应该满足三方面要求：
+ 能比较真实的模拟现实世界
+ 容易为人所理解
+ 便于在计算机上实现

根据模型应用的不同目的，可以将这些模型划分为两大类：第一类为概念模型，第二类是逻辑模型和物理模型。

### 概念模型
概念模型是现实世界到机器世界的一个中间层次。

#### 1、信息世界中的基本概念
1. 实体：客观存在并且可互相区别的事物成为实体
2. 属性：实体所具有的某一特征称为属性
3. 码(key)：唯一标识实体的属性集称为码(也就是主码)
4. 实体型(entity type)： 具有相同属性的实体必然具有共同的特征和性质。用实体名及其属性名集合来抽象和刻画同类实体就称为实体型。例如, 学生(学号，姓名，性别，出生日期)就是一个实体型
5. 实体集(entiry set):同一类实体的集合称为实体集
6. 联系(relationship)：在现实世界中事物内部以及事物与事物之间都是存在联系的。`实体内部`的联系通常是指`实体各属性之间`的联系，`实体之间`的联系通常是指`不同实体集`之间的联系，实体之间的联系有一对一、一对多、多对多等

#### 2、概念模型的一种表示方法：实体-联系方法
该方法用E-R图来描述现实世界的概念模型，E-R方法也称为E-R模型。

### 关系模型

#### 1、关系模型的数据结构
+ 关系：一个关系对应一张表，简单理解关系数据库中关系就是表
+ 元组：表中的一行就是一个元组，也就是记录
+ 码(key): 表中的某个属性组，可以唯一确定一个元组。
+ 域：一组具有相同数据类型的值的集合，简单理解就是值域的意思
+ 分量：元组中的一个属性值，简单理解就是数据项
+ 关系模式：就是对关系的描述：关系名（属性1，属性2，...，属性n）。简单理解就是表头(表格的描述)，比如：学生(学号，姓名)

粗略对比表：

关系术语|一般表格术语
-|-
关系名|表名
关系模式|表头（表格的描述）
关系|表
元组|记录/行
属性|列
分量|数据项
非规范关系|表中有表

#### 2、关系模型的大数据操纵与完整性约束
关系的完整性约束条件包括三大类：
+ 实体完整性
+ 参照完整性
+ 用户自定义完整性

#### 3、关系模型的优缺点
优点：
+ 建立在严格的数学概念的基础上
+ 概念的单一，无论实体内部还是实体之间的联系都用关系来表示，对数据的检索和更新结果也是关系，用户易用易懂
+ 存取路径对用户透明，具有更高的数据独立性和保密性，简化了程序员的工作和数据开发建立的工作

缺点：
+ 由于存取路径对用户隐蔽，查询效率不如格式化数据模型，为了提高性能必须对用户的查询请求进行优化，因此增加了开发难度。

## 数据库系统的结构
从数据开发人员的角度来看，数据系统通常采用`三级模式结构`，这是数据库系统内部的系统结构。

### 数据库系统模式的概念
数据模式中有”型“和”值“ 的概念。<br />
型是指对某一类数据的结构和属性的说明，而值是型的一个具体赋值。如：<br />（学号，姓名，外貌）为型，（04161187，王冰，帅）就是值。

模式（schema）是数据库全体数据的逻辑结构和特征的描述（他妈的，说的这么操蛋，说白了模式就是数据库，创建模式就是创建数据库。。真废话）

### 数据库系统的三级模式结构
数据库系统的三级模式指的是数据库系统是由外模式、模式和内模式三级构成。

#### 1、模式
**模式**也称逻辑模式，是数据库中全体数据的逻辑结构和特征的描述，是所有用户的公共数据视图。
#### 2、外模式
**外模式**也称子模式或用户模式，他是数据库用户能够看见和使用的局部数据的逻辑结构和特征的描述，是数据库用户的数据视图，是与某一应用有关的数据的逻辑表示。
#### 3、内模式
**内模式**又称为存储模式，一个数据只能有一个内模式，他是数据物理结构和存储方式的描述，是数据在数据内部的组织方式。

### 数据库的二级映像功能与数据独立性
数据库系统的三级模式是数据的三个抽象级别，他把数据的具体组织留给数据库管理系统管理，从而使用户能够不关💖数据的具体组织方式与存储。

为了能够在内部实现这三个抽象层次的联系和转换，数据库管理系统在这三级模式之间提供了两层映像：
1. 外模式/模式映像：模式描述的是数据的**全局**逻辑结构，外模式描述的是数据的**局部**逻辑结构。一个模式可以有多个外模式，对于每一个外模式都有一个外模式/模式映像，它定义了对应关系。<br />
当模式改变时，只需要外模式/模式映像做出相应修改即可，这样外模式就不用动，而程序是和外模式打交道的，这样应用程序也不用动了。保证了数据与程序的逻辑独立性，简称数据的`逻辑独立性`。

2. 模式/内模式映像：数据库中只有一个模式，也只有一个内模式，所以模式/内模式映像是唯一的。当数据库的存储结构改变时，只需要对模式/内模式映像进行修改即可，其他均不必做出改变。保证了数据与程序的物理独立性，简称`物理独立性`。

> 数据与程序之间的独立性使得数据的定义、描述可以从应用程序中分离出去，这些数据由DBMS管理，从而简化了应用程序的编制，大大减少了应用程序的维护和修改。

# 关系数据库
关系数据库是支持关系模型的数据库系统。

## 关系数据结构及形式化定义
关系模型由关系数据库结构、关系操作集合、和关系完整性约束三部分组成。

### 关系
关系模型的数据结构就是包含单一的数据结构———关系。
> 关系模型中数据的逻辑结构是一张扁平的二维表。

1. 域：域是一组具有相同数据类型的值的集合（值域）。
2. 笛卡尔积：笛卡尔积是遇上的一种集合运算。
3. 关系：定义在D1*...*Dn上的子集叫做在域上的关系，表示为R(D1,...,Dn)。
> 这里的n，是关系的`目`或`度`(也就是属性的个数)。表的每`行`对应为`元组`，每`列`对应一个`域`，因为域允许相同，所有必须给每列取一个名字，称之为`属性`。<br />如果某一属性组能够唯一的标识一个元组，而其他子集不能，则称该属性组为`候选码`。<br>若一个关系有多个候选码，则其中一个称之为`主码`。<br>包含在候选码中的属性称为主属性，否则称之为非主属性。<br>如果这个关系的所有属性组成候选码，则称为`全码`。

关系可以有三种类型：基本关系、查询表和视图表。
> 其中只有基本关系是实际存在的表，又称为基本表(基表)。而查询表是查询结果组成的表；视图表是由其他基表或视图表导出的表，是续表，不对应实际存储的数据。

### 关系模式
关系的描述称为关系模式。记为R(U,D,DOM,F)。
其中R为关系名，U为属性名集合，D为U中属性所来自的域，DOM为属性向域的映像集合，F为属性间数据的依赖关系集合。

关系是关系模式在某一时刻的状态或内容，关系模式是静态的，关系的动态的。

## 关系的完整性
关系模式中有三类完整性约束：实体完整性、参照完整性、用户自定义完整性。

其中实体完整性和参照完整性是关系模型必须满足的完整性约束条件，被称作是关系的两个不变性。

1. 实体完整性：设A为关系的主属性，则A不能取空值。
2. 参照完整性：外键的值必须为null或者悲惨找关系的主码。
3. 用户自定义完整性：。

## 关系代数
