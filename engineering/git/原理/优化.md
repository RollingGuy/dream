

git 每次 fetch/pull 都会把仓库历史中所有出现的文件都获取到本地，虽然已经经过 zlib 压缩过，但是如果在某次提交的时候，提交了体积过大的文件，即使在之后的提交中已经删除了该文件， Git 每次依然会下载这个文件。

找到这个最大的文件：
```sh
➜ git verify-pack -v .git/objects/pack/pack-xxxx.idx \
  | sort -k 3 -n \ # -k 是根据 key 来排序，3 是说每行第 3 个 key
  | tail -3 # 只列出最后 3个

a12984cdfbc12a55a2f442864789c3423cd7f31b blob   271018 251537 602446
9f6c19646950500661a0f373da173ef44bed8115 blob   492154 406458 2322334
efb784b03c5c83b3d8e90c7e389dd08357075b53 blob   857373 832495 2728792
```
最底下的就是体积最大的文件了。

现在只是找到 blob 的 hash，还不知道它对应那个文件：
```sh
➜ git rev-list --objects --all | grep efb7
efb784b03c5c83b3d8e90c7e389dd08357075b53
efb784b03c5c83b3d8e90c7e389dd08357075b53 others/bytedance-get/思维导图.jpg
```
好了，找到了  我的仓库里，最大的是 `others/bytedance-get/思维导图.jpg`。 好像有 837.28kb。

干掉：
现在需要从过去所有的 tree 中移除这个文件：
```sh

➜ git log --oneline --branches -- others/bytedance-get/思维导图.jpg
# 找到添加这个文件的 commit 了: 34df46c
34df46c core: dir change
➜ git filter-branch --index-filter 'git rm --ignore-unmatch --cached others/bytedance-get/思维导图.jpg' -- 34df46c^..
```
。现在删掉它：
```sh

```
filter-branch

@TODO


# 总结

学到的指令：
+ `git rev-list` 根据时间列出提交对象
+ `git prune` 删除没有被引用的 object